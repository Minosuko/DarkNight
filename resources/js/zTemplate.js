/*! Z Template | (c) Daniel Sevcik | MIT License | https://github.com/webdevelopers-eu/z-template | build 2023-07-29T14:11:19+00:00 */ window.zTemplate=function(){var _Mathmax=Math.max;function tokenize(e){let t=new Tokenizer(e);return t.tokenize(),t}function prepare(e,t){return new Preparator(e,t).prepare()}function zTemplate(e,t,a={}){let r=new Map(Object.entries(a||{})),l=new Map([...zTemplate.callbacks.entries(),...r.entries()]),n=new Template(e instanceof Document?e.documentElement:e);return n.render(t,l)}class Tokenizer extends Array{#a=["!","=","<",">","~","|","&"];#b=["'",'"'];#c={"{":"}","[":"]","(":")"};#d=[","];#e=[" ","	","\r","\n"];#f;#g=0;constructor(e){super(),this.#f=(e||"")+""}tokenize(){for(;!this.#h();){let e=this.#i();if(null===e)break;this.push(e)}}#h(){return this.#g>=this.#f.length}#j(){return this.#h()?null:this.#f[this.#g++]}#k(){return 0>=this.#g?null:this.#f[--this.#g]}#i(e=","){let t=new Tokenizer(this.#f),a={type:"generic",value:""},r=!1;for(let l=this.#j();null!==l;l=this.#j())if(r||"text"==a.type&&l!=a.delimiter)a.value+=l,r=!1;else if("\\"===l)r=!0;else if("text"==a.type&&l==a.delimiter)this.#l(t,a),a={type:"generic",value:""};else if(l===e)break;else l in this.#c?(this.#l(t,a),t.push({type:"block",value:this.#i(this.#c[l]),start:l,end:this.#c[l]}),a={type:"generic",value:""}):this.#b.includes(l)?(this.#l(t,a),a={type:"text",value:"",delimiter:l}):"generic"==a.type&&this.#d.includes(l)?(this.#l(t,a),this.#l(t,{type:"separator",value:l}),a={type:"generic",value:""}):"generic"==a.type&&this.#e.includes(l)?(this.#l(t,a),a={type:"generic",value:""}):"operator"!==a.type&&this.#a.includes(l)?(this.#l(t,a),a={type:"operator",value:l}):"operator"!==a.type||this.#a.includes(l)?a.value+=l:(this.#l(t,a),a={type:"generic",value:""},this.#k());return this.#l(t,a),t}#l(n,s){if("generic"==s.type){if(s.value=s.value.trim(),!s.value.length)return;isNaN(s.value)||(s.type="text",s.value=new Number(s.value))}n.push(s)}}class Preparator{#m;#n;#o={"@*":"attr",":*":"event","**":"call",".*":"class","+":"html",".":"text","=":"value","?":"toggle","!":"remove","`":"debugger"};#p=["==","!=",">",">=","<","<="];#q=["!","&&","||"];#r={negateValue:0,variable:null,value:null,valueBool:null,action:"",param:null,arguments:[],condition:null};constructor(e,t){if("object"!=typeof t)throw Error(`The variables must be an object. Current argument: ${typeof t}.`);this.#m=t,this.#n=e,this.#s()}#s(){let e=Array.from(this.#n),t=this.#t(e,["operator","generic","block","text"]);"operator"===t.type&&["!","!!"].includes(t.value)&&(this.#r.negateValue=t.value.length,t=this.#t(e,["generic","block","text"])),"generic"===t.type?(this.#r.variable=t.value,this.#r.value=this.#u(t.value)):"block"===t.type?this.#r.value=this.#v(t.value):this.#r.value=t.value,t=this.#t(e,["generic","operator"]);let a=t.value.substr(0,1)+(1<t.value.length?"*":"");if(void 0!==this.#o[a])this.#r.action=this.#o[a],e.unshift({type:"text",value:t.value.substr(1),info:"Extracted from shortcut"});else if(Object.values(this.#o).includes(t.value))this.#r.action=t.value;else throw Error(`Invalid action: ${t.value} . Supported actions: ${Object.keys(this.#o).join(", ")}`);t=this.#t(e,["text","generic",null],["block","operator"]),this.#r.param=t?.value,"block"===(t=this.#t(e,["block","operator",null]))?.type&&"("==t.start&&(this.#r.arguments=this.#w(t.value),t=this.#t(e,["block","operator",null]));let r=0;"operator"===t?.type&&["!","!!"].includes(t.value)&&(r=t.value.length,t=this.#t(e,["block",null])),"block"===t?.type&&"{"==t.start?(this.#r.condition=this.#v(t.value),t=this.#t(e,["block",null])):this.#r.condition=!0,this.#r.condition=this.#x(this.#r.condition,r),"debugger"===this.#r.action&&this.#r.valueBool}#y(e){return"generic"===e.type?this.#u(e.value):"block"===e.type?this.#v(e.value):e.value}#u(e){let t=e.split(".");switch(t[0]){case"true":case"always":return!0;case"false":case"never":return!1;case"null":case"none":return null;case"undefined":case"z":return}let a=this.#m;for(let r=0;r<t.length;r++){if(void 0===a[t[r]])return console.warn("Can't find variable "+e+" in data source %o",this.#m),null;a=a[t[r]]}return a}prepare(){let e={...this.#r};if("special"===e.condition.type)return e.action=e.condition.value,e.condition=!0,e;switch(e.value=null===e.value&&"generic"==e.condition.type?this.#z(e.condition,e.negateValue):"object"==typeof e.value?this.#z(e.value,e.negateValue):this.#x(e.value,e.negateValue),e.valueBool=this.#A(e.value),e.condition.type){case"block":e.condition=!!this.#v(e.condition.value);break;case"generic":e.condition=!!this.#B(e.condition.value)}return e}#w(e){let t=[],a=[];for(let r=0;r<e.length;r++){let l=e[r];"separator"===l.type?(t.push(a),a=[]):a.push(l)}return t.push(a),t=t.map(e=>1==e.length?this.#y(e[0]):this.#y({type:"block",value:e}))}#B(e){let t=this.#u(e);return null===t?null:this.#A(t)}#A(e){switch(typeof e){case"string":return 0!==e.length;case"object":return null!==e&&0!==Object.keys(e).length;case"number":return 0!==e;case"boolean":return e;default:return!1}}#v(tokens){let expression=this.#C(tokens);return eval(expression)}#C(e){let t="";for(;;){let a=this.#t(e,["generic","block","text","operator",null]);if(!a)break;if(1<e.length&&"operator"===e[0].type&&this.#p.includes(e[0].value)){let r=this.#t(e,["operator"]),l=this.#t(e,["generic","text"]);t+=this.#D(a,r,l)?1:0;continue}switch(a.type){case"operator":if(this.#q.includes(a.value))t+=a.value;else throw Error(`Invalid operator: ${a.value}. Supported operators: ${this.#q.join(", ")}`);break;case"block":t+=this.#C(a.value);break;case"generic":t+=this.#B(a.value)?1:0;break;case"text":t+=this.#A(a.value)?1:0}}return"("+(t||"0")+")"}#z(e,t=0){let a=e;if(void 0!==e?.type&&void 0!==e?.value)switch(e.type){case"generic":a=this.#u(e.value);break;case"text":a=e.value;break;case"block":a=this.#v(e.value);break;default:throw Error(`Invalid token type: ${e.type} (value: ${JSON.stringify(e)}).`)}if(null===a)return a;a instanceof Array?a=a.length:a instanceof Number?a=a.valueOf():"object"==typeof a&&(a=Object.keys(a).length);let r=+a,l=isNaN(r)?a:r.valueOf();return this.#x(l,t)}#D(e,t,a){let r=this.#z(e),l=this.#z(a);switch(t.value){case"==":return r===l?1:0;case"!=":return r===l?0:1;case"<":return r<l?1:0;case"<=":return r<=l?1:0;case">":return r>l?1:0;case">=":return r>=l?1:0;default:throw Error(`Invalid operator: ${t.value} . Supported operators: ${this.#p.join(", ")}`)}}#t(e,t=[],a=[]){let r=e.shift();if(a.includes(r?.type))return e.unshift(r),null;if(!t.includes(r?r.type:null))throw Error(`Invalid z-var value: (${r&&r.type}) ${JSON.stringify(r)}. Expected: ${JSON.stringify(t)}`);return r}#x(e,t=0){for(let a=t;a;a--)e=!e;return e}}class Template{#E=null;#m=null;#F={};#G=0;#H="*[starts-with(@template, '{') or starts-with(@template, '[')]";#I="*[@z-removed or (@template-scope and @template-scope != 'inherit') or (@z-scope-children and @z-scope-children != 'inherit')]";#J=`*[self::${this.#H} or @z-scope or parent::${this.#I} or @template-clone or ancestor::*/@z-removed]`;#K="*[@z-var]";#L=`count(ancestor-or-self::${this.#J})`;constructor(e){if(!(e instanceof Element))throw Error("ZTemplate accepts an instance of HTMLElement as constructor argument");this.#E=e,this.#G=this.#M(this.#L,e.hasAttribute("template-scope")||e.hasAttribute("z-scope-children")?e.firstElementChild:e)}render(e,t){this.#m=e,this.#F=t;let a=this.#M(`self::${this.#K}|descendant-or-self::${this.#K}[${this.#L} = ${this.#G}]`);for(let r=0;r<a.length;r++)this.#N(a[r]);let l=this.#M(`self::${this.#H}|${this.#H}|descendant-or-self::${this.#H}[${this.#L} = ${this.#G} + 1]`);for(let n=0;n<l.length;n++)this.#O(l[n])}#O(e){let t=e.getAttribute("template"),a=t.substring(1,t.length-1);if(!a)throw Error(`Template "${a}" not found (attr template="${t}")`);let r=this.#u(a);if(null===r)return void console.warn(`Template "${a}" not found in data`,this.#m);let l;"{"==t.substr(0,1)?l=[r]:r&&r[Symbol.iterator]?l=Array.from(r):"object"==typeof r?l=Object.entries(r).map(([e,t])=>({key:e,value:t})):(console.warn("Template value '%s' is not iterable: %o. Template: %o",a,r,e),l=[]);let n=this.#P(e,l),s=l.length,o=[e];for(let u=n.length-1;0<=u;u--){let c=n[u];switch(c.action){case"reuse":case"add":let h="object"==typeof l[--s]?l[s]:{value:l[s],key:s};h._parent_=this.#m;for(let p=c.elements.length-1;0<=p;p--){let d=c.elements[p];if("add"==c.action){for(;o.length&&!o[0].parentNode;)o.shift();o[0].before(d)}let m=new Template(d);m.render(h,this.#F),o.unshift(d)}break;case"remove":c.elements.forEach(e=>this.#Q(e))}}}#P(v,f){f.length;let g=v.getAttribute("template"),b=[],y=[],k=v.previousElementSibling,$=-1,x=-1;for(;k&&k.getAttribute("template-clone")==g;){let w=k.getAttribute("template-clone-id");x=_Mathmax(x,w),k.hasAttribute("z-removed")||($==w&&null!==w?y[0].unshift(k):y.unshift([k])),k=k.previousElementSibling,$=w}let _=f.map(e=>this.#R(e)),T=y.map(e=>e[0].getAttribute("template-clone-hash"));for(;_.length||T.length;){let z=_.shift(),A=T.shift();if(z==A)b.push({elements:y.shift(),action:"reuse"});else{let E=T.indexOf(z),C=_.indexOf(A);if(z&&(!A||-1!=C)&&(-1==E||C<E))b.push({elements:this.#S(v,{"template-clone":g,"template-clone-id":++x,"template-clone-hash":z}),action:"add"}),A&&T.unshift(A);else{let S=y.shift();b.push({elements:S,action:"remove"}),z&&_.unshift(z)}}}return b}#S(L,V){let B=[];return L.content instanceof DocumentFragment?B.push(...Array.from(L.content.children).map(e=>e.cloneNode(!0))):B.push(L.cloneNode(!0)),B.forEach(e=>{for(let[t,a]of(e.classList.add("template-clone"),e.removeAttribute("template"),Object.entries(V)))e.setAttribute(t,a)}),B}#N(O){let N=O.getAttribute("z-var"),R=tokenize(N),j=Array.from(R).map(e=>prepare(e,this.#m)),P=[],D=this.#T(O);j.forEach(e=>{if(e.condition){if(null===e.value)return void console.warn("The command %o's value is null. Skipping the condition. Variables: %o",e,this.#m);switch(e.action){case"attr":this.#U(D,e);break;case"text":this.#V(D,e);break;case"html":this.#W(D,e);break;case"value":this.#X(D,e);break;case"class":this.#Y(D,e);break;case"toggle":this.#Z(D,e);break;case"debugger":e.valueBool;break;case"remove":case"event":case"call":P.push(e)}}}),this.#$(O,D),P.forEach(e=>{switch(O.parentNode||console.warn("The element %o was removed from the DOM. Something may break when executing the command %o",O,e),e.action){case"remove":this.#_(O,e);break;case"event":this.#aa(O,e);break;case"call":this.#ab(O,e)}})}#ab(I,H){let M=this.#F.get(H.param);if(!M||"function"!=typeof M)return void console.error(`Callback "${H.param}" not found or is not a function in command "${JSON.stringify(H)}"`);let Y={value:H.value,data:this.#m,arguments:H.arguments};return"function"==typeof M?void M(I,Y):void console.error(`Callback ${H.param} is not defined`)}#aa(q,U){let Z={value:U.value,data:this.#m,arguments:U.arguments},F=new CustomEvent(U.param,{detail:Z,bubbles:!0,cancelable:!0,composed:!1});q.dispatchEvent(F)}#_(G,W){W.valueBool||this.#Q(G)}#Z(J,K){J.classList.contains("z-template-hidden")||(K.valueBool?(J.classList.add("z-template-visible"),J.classList.remove("z-template-hidden")):(J.classList.add("z-template-hidden"),J.classList.remove("z-template-visible")))}#Y(Q,X){let ee=X.param.trim().split(/[ ,.]+/);ee.forEach(e=>{let t=X.valueBool;"!"===e.substr(0,1)&&(t=!t,e=e.substr(1)),t?Q.classList.add(e):Q.classList.remove(e)})}#X(et,ea){if(et.matches('input[type="checkbox"], input[type="radio"]')){let er="boolean"==typeof ea.value?ea.value:et.value===ea.value;er?et.setAttribute("checked","checked"):et.removeAttribute("checked")}else et.matches("input")?et.setAttribute("value",ea.value):et.matches("select")?Array.from(et).filter(e=>e.value===ea.value).forEach(e=>e.setAttribute("selected","selected")):et.matches("textarea")?et.textContent=ea.value:et.setAttribute("value",ea.value)}#W(el,en){el.innerHTML=en.value}#V(ei,es){ei.textContent=this.#ac(ei,ei.textContent,es.variable,void 0===es.value||null===es.value||!1===es.value?"":es.value,"")}#U(eo,eu){if(!0===eu.value)eo.setAttribute(eu.param,eu.param);else if(!1===eu.value)eo.removeAttribute(eu.param);else{let ec=this.#ac(eo,eo.getAttribute(eu.param),eu.variable,eu.value,eu.param);eo.setAttribute(eu.param,ec)}}#ac(eh,ep,ed,em,ev=""){let ef="${"+ed+"}",eg="z-var-content"+(ev?"-"+ev:""),eb;return eb=ed&&ep&&-1!==ep.indexOf(ef)?(ep||"").replace(ef,em):ed&&ep&&["src","href"].includes(ev)&&-1!==ep.indexOf(encodeURIComponent(ef))?(ep||"").replace(encodeURIComponent(ef),encodeURIComponent(em)):em,ep!==eb&&ep&&!eh.hasAttribute(eg)&&(-1!==ep.indexOf("${")||-1!==ep.indexOf(encodeURIComponent("${")))&&eh.setAttribute(eg,ep),eb}#$(ey,ek){let e$=!1;ey.innerHTML!==ek.innerHTML&&(ey.innerHTML=ek.innerHTML,e$=!0);for(let ex=0;ex<ek.attributes.length;ex++){let ew=ek.attributes[ex];ey.getAttribute(ew.name)!==ew.value&&ey.setAttribute(ew.name,ew.value)}for(let e_=0;e_<ey.attributes.length;e_++){let eT=ey.attributes[e_];ek.hasAttribute(eT.name)||ey.removeAttribute(eT.name)}if(e$){let ez=parseInt(ey.getAttribute("z-content-rev")||0)+1;ey.removeAttribute("z-content-rev"),setTimeout(()=>ey.setAttribute("z-content-rev",ez),0)}}#T(eA){let eE=eA.cloneNode(!0),e9=[];return Array.from(eA.attributes).filter(e=>{e.name.match(/^z-var-content-?/)&&e9.push(e),eE.setAttribute(e.name,e.value)}),e9.forEach(e=>{let t=e.name.replace(/^z-var-content-?/,"");t?eE.setAttribute(t,e.value):eE.textContent=e.value}),eE.classList.remove(...["dna-template-visible","z-template-visible","dna-template-hidden","z-template-hidden"]),eE}#M(eC,eS=null){let eL=this.#E.ownerDocument.evaluate(eC,eS||this.#E,null,XPathResult.ANY_TYPE,null);switch(eL.resultType){case XPathResult.NUMBER_TYPE:return eL.numberValue;case XPathResult.STRING_TYPE:return eL.stringValue;case XPathResult.BOOLEAN_TYPE:return eL.booleanValue;case XPathResult.UNORDERED_NODE_ITERATOR_TYPE:for(var eV,eB=[];eV=eL.iterateNext();eB.push(eV));return eB;default:return null}}#u(eO){let eN=eO.split("."),eR=this.#m;for(let ej=0;ej<eN.length;ej++){if(void 0===eR[eN[ej]])return console.warn("Can't find variable "+eO+" in data source %o",this.#m),null;eR=eR[eN[ej]]}return eR}#R(e8){let eP;if("object"==typeof e8&&void 0!==e8.id){if("string"==typeof e8.id||"number"==typeof e8.id)return e8.id;eP=JSON.stringify(e8.id)}else eP=JSON.stringify(e8,(e,t)=>"_parent_"==e?void 0:t);for(var eD,eI=[],eH=0;256>eH;eH++){eD=eH;for(var eM=0;8>eM;eM++)eD=1&eD?3988292384^eD>>>1:eD>>>1;eI[eH]=eD}for(var eY=-1,eH=0;eH<eP.length;eH++)eY=eY>>>8^eI[255&(eY^eP.charCodeAt(eH))];return""+((-1^eY)>>>0)}#Q(e0){if(e0.hasAttribute("z-removed")||!e0.parentNode)return;let e6=window.getComputedStyle(e0).animationName;e0.setAttribute("z-removed","true");let eq=window.getComputedStyle(e0),eU=eq.animationName,e1=1e3*((parseFloat(eq.animationDuration)||0)+(parseFloat(eq.animationDelay)||0)),e3=_Mathmax(200,e1),eZ=new Promise(e=>{e6===eU?e():(e0.addEventListener("animationend",e),e0.removeEventListener("animationcancel",e),e0.removeEventListener("animationiteration",e))}),e7=new Promise(e=>{setTimeout(e,e3)}),eF=new Promise(e=>{var t=Math.ceil;let a=e0.getBoundingClientRect();e0.style.height=a.height+"px",e0.style.width=a.width+"px",e0.style.transition="none",e0.style.margin=`${eq.marginTop} ${eq.marginRight} ${eq.marginBottom} ${eq.marginLeft}`,e0.addEventListener("transitionend",e),e0.style.transition=`margin ${e3}ms ease-in-out`,e0.style.marginRight=`-${t(a.height+parseInt(eq.marginLeft))}px`,e0.style.marginBottom=`-${t(a.height+parseInt(eq.marginTop))}px`});Promise.any([Promise.all([eZ,eF]),e7]).then(()=>e0.remove())}}return zTemplate.callbacks=new Map,"undefined"==typeof jQuery||jQuery.fn.template||(jQuery.fn.template=function(e){return this.each((t,a)=>zTemplate(a,e)),this}),zTemplate}(),zTemplate.callbacks.set("roller",function(e,t){let a=e.ownerDocument,r=t.arguments[0]||1e3,l=t.arguments[1]||100,n=e.textContent+"",s=t.value+"",o=Math.max(n.length,s.length),u=a.createDocumentFragment(),c=e.getBoundingClientRect().height;if(n===s||0===n.length){e.textContent=s;return}e.classList.add("z-roller-rolling");for(let h=0;h<o;h++){let p=n[h]||"",d=s[h]||"",m=u.appendChild(a.createElement("div"));m.setAttribute("data-target",d);let{direction:v,chars:f}=k(p,d);"up"===v?m.classList.add("z-roller-up","z-roller"):m.classList.add("z-roller-down","z-roller");let g=m.appendChild(a.createElement("span"));g.classList.add("z-roller-letter"),g.textContent=p,m.style.setProperty("--z-roller-speed",r+"ms"),m.style.setProperty("--z-roller-line-height",c+"px"),m.setAttribute("data-z-face",f.join("\n"))}for(e.replaceChildren(u),i=0;i<e.childElementCount;i++){let b=e.children[i],y=l*i;b.style.setProperty("--z-roller-delay",y+"ms"),b.classList.add("z-roller-animate"),setTimeout(()=>b.replaceWith(b.getAttribute("data-target")),y+r)}function k(e,t){let a=(e||" ").charCodeAt(0),r=(t||" ").charCodeAt(0),l=Math.abs(a-r),n=[],s=a<r?"up":"down";"down"===s&&([a,r]=[r,a]);for(let o=0;o<=l;o++)n.push(String.fromCharCode(a+o));return{direction:s,chars:n}}});
